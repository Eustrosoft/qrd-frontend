<data-view
  [searchValue]="selectors.searchValue()"
  (advancedSearchClicked)="openAdvancedSearch()"
  (searchValueChange)="actions.setQrCardListSearchValue($event)"
>
  <ng-content view-settings>
    @if (!isSmallScreen()) {
      <overlay-container #overlayContainer="overlayContainer">
        <ng-container trigger>
          <button
            (click)="overlayContainer.openOverlay()"
            class="fab-md fab-secondary"
            cdkOverlayOrigin
            mat-fab
            [attr.aria-label]="SharedLocalization.openDataAttrsMenu"
          >
            <mat-icon class="icon-on-secondary">settings</mat-icon>
          </button>
        </ng-container>
        <column-config-overlay
          [allCols]="selectors.allQrCols()"
          [selectedCols]="selectors.settingsState().settings.qrTableColumns"
          [isDisabled]="selectors.settingsState().isLoadingSettings || selectors.settingsState().isSavingSettings"
          (selectedColsChange)="actions.patchSettings({ qrTableColumns: $event })"
          overlayAnimation
          [isOpen]="overlayContainer.isOverlayOpen()"
          (animationDone)="overlayContainer.onOverlayClosed()"
          (closeOverlay)="overlayContainer.onOverlayClosed()"
        />
      </overlay-container>
    }
  </ng-content>
  <selection-bar
    *animatedIf="!!selectors.selectedQrCardList().length"
    [count]="selectors.selectedQrCardList().length"
    (onSelectAll)="actions.selectAllQrCards()"
    (onClose)="actions.setSelectedQrCards([])"
  >
    @if (!selectors.isDeleteInProgress()) {
      <button
        (click)="actions.deleteQrCards(selectors.selectedQrCardList(), destroyRef)"
        class="mini-fab-md mini-fab-secondary"
        mat-mini-fab
      >
        <mat-icon class="icon-on-secondary">delete</mat-icon>
      </button>
    } @else {
      <ui-skeleton width="40" height="40" borderRadius="50%" />
    }
  </selection-bar>
  <ui-grid-block gridTemplateColumns="1fr" rowGapSize="16">
    @if (selectors.ranges().length) {
      <mat-chip-listbox
        [selectable]="true"
        [multiple]="true"
        [attr.aria-label]="SharedLocalization.ranges"
        role="list"
        (change)="actions.fetchQrCards(destroyRef, $event.value)"
      >
        @for (range of selectors.ranges(); track range.id) {
          <mat-chip-option [value]="range.id">
            {{ range.name | fallback: SharedLocalization.emptyName }} {{ range.from | qrRange: range.to }}
          </mat-chip-option>
        }
      </mat-chip-listbox>
    }

    <router-outlet style="display: contents" />
  </ui-grid-block>
</data-view>
